from PIL import Image

# 打開圖片
image = Image.open("lena.png")
image = image.resize((256, 256))

# 自定義量化表
custom_qtables = [
    # 量化表 1 (Luminance)
    [
        1.0,
        1.6620239,
        2.8904095,
        3.689328,
        6.3556643,
        5.7640767,
        5.9784355,
        4.5745554,
        2.4501727,
        4.3399363,
        6.4692564,
        4.348677,
        4.3141294,
        3.4142365,
        3.1845067,
        3.2614062,
        3.3430076,
        5.096093,
        5.332546,
        4.499755,
        3.314779,
        3.8878255,
        1.3782321,
        2.9035583,
        3.653858,
        4.8251123,
        4.8177576,
        4.016813,
        4.127308,
        1.899889,
        3.4585233,
        2.8717973,
        5.2399783,
        5.726188,
        3.55787,
        4.107557,
        1.9837066,
        3.9878838,
        3.4401188,
        1.7927378,
        3.8508253,
        2.1577578,
        1.722563,
        2.3509226,
        2.8583488,
        2.6453843,
        3.1347857,
        3.6719263,
        2.1624215,
        2.1346295,
        3.4708443,
        1.9001681,
        255.0,
        2.4375951,
        3.4905953,
        3.282283,
        3.8120787,
        4.436294,
        2.60845,
        2.563038,
        2.57467,
        3.2983055,
        3.0357149,
        255.0,
    ],
    # 量化表 2 (Chrominance)
    [
        1.0,
        12.975646,
        6.7551274,
        6.5604563,
        3.830638,
        5.1292644,
        234.24661,
        10.049184,
        10.089426,
        7.9320054,
        6.1902723,
        4.350316,
        5.242142,
        255.0,
        255.0,
        255.0,
        7.0492635,
        5.878798,
        5.0404944,
        3.2386842,
        4.494839,
        124.06625,
        96.80514,
        255.0,
        7.7630277,
        4.8038836,
        4.114164,
        5.6102266,
        7.0418787,
        51.094673,
        255.0,
        225.35536,
        4.0970135,
        6.1377616,
        5.3222713,
        252.95053,
        240.50018,
        255.0,
        255.0,
        228.91875,
        5.931461,
        219.80298,
        255.0,
        255.0,
        255.0,
        251.59692,
        255.0,
        255.0,
        255.0,
        255.0,
        229.77493,
        255.0,
        226.64207,
        134.3659,
        255.0,
        255.0,
        255.0,
        122.105415,
        105.751526,
        253.47693,
        255.0,
        156.68997,
        255.0,
        185.78725,
    ],
]

custom_qtables = [
    [min(max(int(round(val)), 1), 255) for val in table] for table in custom_qtables
]

# 保存圖片，並應用自定義量化表
image.save("trained_image.jpg", format="JPEG", qtables=custom_qtables)
image.save("simple_version.jpg", format="JPEG", quality=5)
